#!/bin/bash

projects=("bitflow" "hyperbook" "patches" "org")

for project in ${projects[@]}
do
  path="Sources/openpatch/${project}/main"
  tmux new-session -d -s $project

  window=1
  tmux rename-window -t $project:$window "nvim"
  tmux send-keys -t $project:$window "cd ${path}" C-m
  tmux send-keys -t $project:$window "vim" C-m

  window=2
  tmux new-window -t $project:$window -n "server"
  tmux send-keys -t $project:$window "cd ${path}" C-m
  tmux send-keys -t $project:$window "pnpm dev" C-m

  window=3
  tmux new-window -t $project:$window -n "git"
  tmux send-keys -t $project:$window "cd ${path}" C-m
  tmux send-keys -t $project:$window "git pull" C-m
done

tmux attach-session -t ${projects[0]}:1
